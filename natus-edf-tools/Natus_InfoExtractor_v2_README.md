
# 🧠 Natus Info Extractor v2

The **Natus_InfoExtractor_v2.py** script extracts detailed structured metadata from `.eeg` and `.ent` files generated by the Natus EEG system. It is tailored for researchers and engineers who need robust access to patient-independent metadata for database construction, file management, and export validation in high-throughput SEEG environments.

---

## 📌 Summary

This updated extractor:
- Parses deeply nested key-value trees within `.eeg`/`.ent` files
- Supports multiple versions of metadata fields (e.g., start time, classification)
- Converts **Excel-style timestamps** to readable formats (e.g., 2024-04-18 14:02:00)
- Skips binary or irrelevant data blocks automatically
- Outputs structured **Excel reports** (.xlsx) for research auditing and downstream processing
- Computes **folder-level stats** like size, file count, and EEG content volume

---

## 🚀 Usage

```bash
python Natus_InfoExtractor_v2.py <input_dir> [-o output.xlsx]
```

### Arguments:
- `input_dir`: Folder containing `.eeg` or `.ent` files (recursively scanned)
- `-o, --output`: (Optional) Output Excel file (default: `eeg_metadata.xlsx`)

---

## 🔍 Features

- ✔️ Multi-format and legacy key resolution  
- ✔️ Conversion of timestamps (Excel float → readable time)  
- ✔️ Duplicate/variant field detection and tagging  
- ✔️ Multi-source data aggregation across large datasets  
- ✔️ Defensive handling of malformed or binary data  

---

## 🧪 Example

```bash
python Natus_InfoExtractor_v2.py ./EEG_exports/ --output EEG_Metadata_Apr2025.xlsx
```

---

## 📦 Output

- Excel file with:
  - Metadata per recording
  - Version-tagged fields when variations exist
  - Folder-level stats (size, count, EEG content)
  - Full data lineage (source file paths)

---

## ✅ Dependencies

- Python 3.7+
- `pandas`
- `openpyxl`

Install with:

```bash
pip install pandas openpyxl
```

---

## 👨‍⚕️ Developed by  
**Dr. Milad Khaki**  
Biomedical Data Scientist, LHSC  
`milad.khaki@lhsc.on.ca`
